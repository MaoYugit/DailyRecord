<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>10.图片上传</title>
</head>
<body>
    <input type="file" class="upload">
    <img src="" alt="获取图片" class="my-img">
    <img src="" alt="本地提取的图片" class="my-img2">
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
        // 1. 获取上传的文件
        document.querySelector('.upload').addEventListener('change', e => {
            console.log(e.target.files[0]);
        // 2. 创建一个FormData对象
        const formData = new FormData();  
        formData.append('img', e.target.files[0]);  
        // 3. 发送ajax请求, 提交图片到服务器，获取url网址使用
        axios({
            url: 'http://hmajax.itheima.net/api/uploadimg',
            method: 'post',
            data: formData,
        }).then(result => {
            console.log(result.data.data.url);
            // 4. 将图片显示在页面上
            const imgUrl = result.data.data.url;
            document.querySelector('.my-img').src = imgUrl;
            // 5. 将图片的地址存储到本地存储中
            localStorage.setItem('imgUrl', imgUrl);
            // 6. 从本地存储中获取图片地址并显示
            const storedImgUrl = localStorage.getItem('imgUrl');
            document.querySelector('.my-img2').src = storedImgUrl;
        }).catch(err => {
            console.error('上传图片失败:', err);
        })    
        })
    </script>
</body>
</html>